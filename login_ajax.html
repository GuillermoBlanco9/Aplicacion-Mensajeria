<!DOCTYPE html>
<html>
	<head>
		<title>Login</title>		
		<meta charset = "UTF-8">
		<script>
		function login(){       
			var xhttp = new XMLHttpRequest();                
			xhttp.onreadystatechange = function() { 
				if (this.readyState == 4 && this.status == 200) { 
					if(this.responseText==="FALSE"){ 
						alert("Check user and password"); 
					}else{ 
						alert("Login correct");
						console.log(this.responseText);
						var rows = JSON.parse(this.responseText);
						console.log(rows);
						cargarPaginaPrincipal(user);
					}

				} 
			} 		 
			var user = document.getElementById("user").value; 
			var password = document.getElementById("password").value;  
			var params = "user=" + user + "&password=" + password; 
			xhttp.open("POST", "login_json.php", true);      
			xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"); 
			xhttp.send(params);              
			return false;
		} 

		function cargarPaginaPrincipal(user)
		{
			//Estructura de la p√°gina 
			document.body.removeChild(document.getElementById("form"));
			var principal = document.createElement('div');
			principal.id = "contenedor-principal";
			var chat = document.createElement('div');
			chat.id = "chat";
			var h3 = document.createElement('h3');
			h3.innerHTML = 'CHATS';
			chat.appendChild(h2);
			var conver = document.createElement('div');
			conver.id = "conver";
			var h2 = document.createElement('h2');
			h2.innerHTML = 'WELCOME ' + user;
			principal.appendChild(chat);
			principal.appendChild(conver);
			document.body.appendChild(principal);

			//Peticion para los chats
			/*var xhttp = new XMLHttpRequest();                
			xhttp.onreadystatechange = function() { 
				if (this.readyState == 4 && this.status == 200) { 
					if(this.responseText==="FALSE"){ 
						alert("Check user and password"); 
					}else{ 
						alert("Login correct");
						console.log(this.responseText);
						var rows = JSON.parse(this.responseText);
						console.log(rows);
						cargarPaginaPrincipal(user);
					}

				} 
			} 		 
			var params = "user=" + user; */
			//xhttp.open("POST", "get_chats.php", true);      
			//xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"); 
			//xhttp.send(params); 
		}
			
		</script>
		
	</head>

	<body>
		<form id = "form"onsubmit = "return login();">
			<input id = "user">
			<input id = "password">
			<input type = "submit">
		</form>

	</body>
 